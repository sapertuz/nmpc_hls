// Fast Sin and Cosine Library
#ifndef FAST_SIN_COS_HPP
#define FAST_SIN_COS_HPP

#include <stdio.h>
#include <math.h>
#include <iostream>

#ifdef __SYNTHESIS__
#include "hls_math.h"
#include "ap_fixed.h"
#endif

#define MAX_CIRCLE_ANGLE 1024     //512
#define HALF_MAX_CIRCLE_ANGLE (MAX_CIRCLE_ANGLE/2)
#define QUARTER_MAX_CIRCLE_ANGLE (MAX_CIRCLE_ANGLE/4)
#define MASK_MAX_CIRCLE_ANGLE (MAX_CIRCLE_ANGLE - 1)
#define LOCAL_PI 3.14159265358979323846f
#define HALF_MAX_CIRCLE_ANGLE_PI (HALF_MAX_CIRCLE_ANGLE / LOCAL_PI)
#define PI_HALF_MAX_CIRCLE_ANGLE (LOCAL_PI / HALF_MAX_CIRCLE_ANGLE)

template<
    typename _real
>class fast_cossin_table_class{
public:
    fast_cossin_table_class(){
#ifdef __VITIS_HLS__
#pragma HLS bind_storage variable=table type=ROM_1P impl=BRAM
#endif
    }

    const _real table[MAX_CIRCLE_ANGLE] = 
    {
0.0,0.006147892100070982,0.012295551828667399,0.018442746823097614,0.024589244738235518,0.030734813255302463,0.036879220090648195,0.04302223300453047,0.049163619809893006,0.055303148381141434,0.06144058666291694,0.06757570267886724,0.07370826454041458,0.07983804045552043,0.08596479873744647,0.09208830781351167,0.098208336233845,0.10432465268013362,0.11043702597436585,0.11654522508756911,0.12264901914854204,0.12874817745258077,0.13484246947019884,0.14093166485584052,0.14701553345658702,0.15309384532085585,0.15916637070709203,0.16523288009245177,0.1712931441814776,0.1773469339147651,0.1833940204776208,0.18943417530871032,0.19546717010869763,0.20149277684887387,0.2075107677797762,0.21352091543979604,0.21952299266377637,0.22551677259159797,0.23150202867675393,0.23747853469491242,0.24344606475246747,0.24940439329507672,0.255353295116187,0.2612925453655463,0.26722191955770236,0.2731411935804876,0.2790501437034901,0.28494854658650937,0.29083617928799843,0.29671281927349025,0.30257824442400855,0.30843223304446354,0.31427456387203123,0.3201050160845165,0.3259233693086993,0.3317294036286644,0.3375228995941133,0.34330363822865884,0.349071401038102,0.3548259700186902,0.36056712766535676,0.36629465697994273,0.3720083414793982,0.3777079652039648,0.38339331272533833,0.38906416915481135,0.39472032015139524,0.4003615519299217,0.40598765126912306,0.41159840551969157,0.4171936026123168,0.422773031065701,0.4283364799945529,0.4338837391175581,0.4394145987653273,0.444928849888321,0.4504262840647512,0.45590669350845875,0.4613698710767673,0.4668156102783126,0.4722437052808471,0.47765395091901985,0.48304614270213136,0.4884200768218623,0.4937755501599772,0.49911236029600153,0.5044303055148723,0.5097291848145631,0.5150087979136803,0.5202689452590338,0.5255094280331793,0.5307300481619334,0.5359306083218588,0.5411109119477246,0.5462707632399342,0.5514099671719267,0.556528329497548,0.561625656758393,0.5667017562911176,0.5717564362347204,0.576789505537795,0.581800773965751,0.5867900521080045,0.5917571513851364,0.5967018840560212,0.6016240632249226,0.6065235028485568,0.6114000177431259,0.6162534235913163,0.6210835369492653,0.625890175253495,0.6306731568278127,0.6354323008901774,0.6401674275595332,0.6448783578626076,0.649564913740677,0.6542269180562963,0.6588641945999939,0.6634765680969326,0.6680638642135335,0.6726259095640662,0.6771625317172018,0.6816735592025301,0.6861588215170413,0.6906181491315697,0.6950513734972019,0.6994583270516471,0.7038388432255709,0.7081927564488907,0.7125199021570339,0.7168201167971578,0.7210932378343319,0.7253391037576805,0.7295575540864875,0.7337484293762626,0.7379115712247672,0.7420468222780019,0.7461540262361539,0.7502330278595043,0.7542836729742965,0.7583058084785624,0.7622992823479104,0.7662639436412703,0.7701996425065992,0.7741062301865452,0.7779835590240701,0.7818314824680298,0.7856498550787143,0.7894385325333445,0.793197371631527,0.796926230300667,0.8006249676013378,0.8042934437326082,0.8079315200373265,0.811539059007361,0.815115924288798,0.8186619806870948,0.8221770941721904,0.8256611318835709,0.8291139621352914,0.8325354544209532,0.8359254794186368,0.8392839089957896,0.8426106162140693,0.845905475334141,0.8491683618204308,0.852399152345832,0.8555977247963672,0.8587639582758029,0.8618977331102202,0.8649989308525372,0.8680674342869859,0.8711031274335433,0.8741058955523147,0.8770756251478704,0.8800122039735355,0.8829155210356329,0.8857854665976779,0.888621932184526,0.8914248105864739,0.89419399586331,0.8969293833483204,0.8996308696522434,0.9022983526671783,0.9049317315704446,0.9075309068283925,0.9100957802001655,0.9126262547414126,0.9151222348079536,0.9175836260593937,0.9200103354626891,0.9224022712956635,0.9247593431504753,0.927081461937034,0.929368539886368,0.9316204905539424,0.9338372288229252,0.9360186709074053,0.9381647343555596,0.9402753380527684,0.9423504022246824,0.9443898484402369,0.9463935996146172,0.9483615800121715,0.9502937152492738,0.9521899322971352,0.9540501594845643,0.955874326500676,0.9576623643975494,0.9594142055928333,0.9611297838723007,0.9628090343923521,0.9644518936824656,0.9660582996475965,0.9676281915705237,0.9691615101141451,0.9706581973237205,0.9721181966290613,0.9735414528466696,0.9749279121818236,0.9762775222306105,0.977590231981908,0.9788659918193116,0.9801047535230103,0.9813064702716093,0.9824710966438995,0.9835985886205743,0.9846889035858932,0.9857420003292932,0.9867578390469456,0.9877363813432609,0.9886775902323404,0.9895814301393732,0.9904478669019816,0.9912768677715121,0.9920684014142734,0.9928224379127202,0.9935389487665842,0.994217906893952,0.9948592866322874,0.9954630637394027,0.9960292153943743,0.996557720198405,0.9970485581756335,0.9975017107738889,0.9979171608653922,0.9982948927474035,0.9986348921428155,0.9989371462006937,0.999201643496761,0.9994283740338304,0.9996173292421829,0.9997685019798909,0.999881886533088,0.999957478616186,0.9999952753720357,0.9999952753720357,0.999957478616186,0.999881886533088,0.9997685019798909,0.9996173292421829,0.9994283740338304,0.999201643496761,0.9989371462006937,0.9986348921428155,0.9982948927474035,0.9979171608653922,0.9975017107738889,0.9970485581756335,0.996557720198405,0.9960292153943743,0.9954630637394027,0.9948592866322874,0.994217906893952,0.9935389487665842,0.9928224379127202,0.9920684014142734,0.9912768677715122,0.9904478669019816,0.9895814301393732,0.9886775902323405,0.987736381343261,0.9867578390469456,0.9857420003292933,0.9846889035858933,0.9835985886205744,0.9824710966438996,0.9813064702716093,0.9801047535230103,0.9788659918193116,0.977590231981908,0.9762775222306106,0.9749279121818236,0.9735414528466697,0.9721181966290613,0.9706581973237205,0.9691615101141452,0.9676281915705237,0.9660582996475966,0.9644518936824658,0.9628090343923522,0.9611297838723007,0.9594142055928333,0.9576623643975495,0.9558743265006762,0.9540501594845644,0.9521899322971352,0.9502937152492739,0.9483615800121716,0.9463935996146173,0.944389848440237,0.9423504022246824,0.9402753380527685,0.9381647343555597,0.9360186709074054,0.9338372288229252,0.9316204905539426,0.9293685398863683,0.927081461937034,0.9247593431504754,0.9224022712956635,0.9200103354626892,0.9175836260593938,0.9151222348079537,0.9126262547414127,0.9100957802001656,0.9075309068283927,0.9049317315704447,0.9022983526671784,0.8996308696522435,0.8969293833483204,0.8941939958633102,0.891424810586474,0.8886219321845261,0.8857854665976779,0.8829155210356331,0.8800122039735357,0.8770756251478704,0.8741058955523148,0.8711031274335435,0.8680674342869859,0.8649989308525372,0.8618977331102204,0.8587639582758032,0.8555977247963672,0.8523991523458322,0.849168361820431,0.8459054753341411,0.8426106162140694,0.8392839089957899,0.8359254794186372,0.8325354544209533,0.8291139621352916,0.8256611318835713,0.8221770941721905,0.818661980687095,0.8151159242887982,0.8115390590073612,0.8079315200373265,0.8042934437326084,0.8006249676013381,0.7969262303006671,0.7931973716315271,0.7894385325333447,0.7856498550787143,0.7818314824680299,0.7779835590240702,0.7741062301865456,0.7701996425065992,0.7662639436412704,0.7622992823479107,0.7583058084785625,0.7542836729742967,0.7502330278595046,0.7461540262361542,0.742046822278002,0.7379115712247674,0.7337484293762628,0.7295575540864875,0.7253391037576805,0.7210932378343321,0.7168201167971582,0.7125199021570339,0.7081927564488908,0.7038388432255711,0.6994583270516471,0.6950513734972019,0.6906181491315699,0.6861588215170417,0.6816735592025303,0.677162531717202,0.6726259095640664,0.6680638642135335,0.6634765680969327,0.6588641945999941,0.6542269180562966,0.6495649137406772,0.6448783578626077,0.6401674275595334,0.6354323008901774,0.6306731568278129,0.6258901752534952,0.6210835369492657,0.6162534235913164,0.6114000177431261,0.606523502848557,0.6016240632249226,0.5967018840560214,0.5917571513851367,0.5867900521080048,0.5818007739657511,0.5767895055377952,0.5717564362347206,0.5667017562911176,0.5616256567583933,0.5565283294975484,0.551409967171927,0.5462707632399343,0.5411109119477248,0.5359306083218591,0.5307300481619334,0.5255094280331796,0.5202689452590341,0.5150087979136806,0.5097291848145632,0.5044303055148726,0.4991123602960018,0.49377555015997726,0.4884200768218625,0.48304614270213164,0.47765395091902024,0.4722437052808472,0.4668156102783128,0.4613698710767677,0.4559066935084588,0.4504262840647514,0.44492884988832127,0.4394145987653277,0.43388373911755823,0.42833647999455315,0.4227730310657014,0.41719360261231686,0.4115984055196918,0.4059876512691234,0.4003615519299221,0.39472032015139535,0.3890641691548116,0.3833933127253387,0.3777079652039649,0.37200834147939843,0.36629465697994307,0.3605671276653572,0.3548259700186903,0.3490714010381023,0.3433036382286592,0.33752289959411336,0.3317294036286646,0.32592336930869964,0.32010501608451697,0.3142745638720314,0.3084322330444638,0.30257824442400894,0.2967128192734903,0.29083617928799865,0.2849485465865097,0.27905014370349013,0.2731411935804878,0.26722191955770264,0.2612925453655467,0.2553532951161871,0.24940439329507694,0.2434460647524678,0.23747853469491245,0.23150202867675407,0.22551677259159825,0.21952299266377678,0.21352091543979612,0.20751076777977642,0.2014927768488742,0.19546717010869766,0.18943417530871048,0.18339402047762107,0.17734693391476553,0.17129314418147767,0.165232880092452,0.1591663707070924,0.1530938453208559,0.1470155334565872,0.1409316648558408,0.1348424694701993,0.12874817745258088,0.12264901914854227,0.11654522508756947,0.1104370259743659,0.1043246526801338,0.09820833623384531,0.09208830781351209,0.08596479873744658,0.07983804045552068,0.07370826454041496,0.0675757026788673,0.06144058666291712,0.055303148381141747,0.04916361980989344,0.04302223300453059,0.03687922009064844,0.030734813255302834,0.024589244738235573,0.018442746823097798,0.012295551828667711,0.006147892100071422,1.2246467991473532e-16,-0.006147892100070732,-0.012295551828667022,-0.018442746823097555,-0.02458924473823533,-0.030734813255302147,-0.03687922009064775,-0.04302223300453034,-0.049163619809892756,-0.05530314838114105,-0.06144058666291688,-0.06757570267886705,-0.07370826454041426,-0.07983804045551998,-0.08596479873744634,-0.0920883078135114,-0.09820833623384462,-0.10432465268013355,-0.11043702597436565,-0.11654522508756879,-0.1226490191485416,-0.12874817745258066,-0.1348424694701986,-0.14093166485584013,-0.14701553345658697,-0.15309384532085565,-0.15916637070709172,-0.16523288009245132,-0.17129314418147745,-0.17734693391476486,-0.1833940204776204,-0.18943417530871023,-0.19546717010869744,-0.20149277684887354,-0.20751076777977576,-0.2135209154397959,-0.21952299266377612,-0.22551677259159758,-0.23150202867675382,-0.23747853469491223,-0.24344606475246713,-0.24940439329507627,-0.2553532951161869,-0.261292545365546,-0.26722191955770197,-0.27314119358048755,-0.27905014370348985,-0.28494854658650903,-0.290836179287998,-0.2967128192734901,-0.30257824442400827,-0.30843223304446316,-0.3142745638720312,-0.3201050160845163,-0.325923369308699,-0.3317294036286643,-0.33752289959411313,-0.3433036382286586,-0.3490714010381017,-0.3548259700186901,-0.36056712766535653,-0.36629465697994246,-0.3720083414793982,-0.37770796520396466,-0.38339331272533805,-0.38906416915481096,-0.39472032015139513,-0.4003615519299215,-0.4059876512691228,-0.41159840551969157,-0.41719360261231664,-0.42277303106570074,-0.42833647999455254,-0.433883739117558,-0.43941459876532707,-0.44492884988832065,-0.45042628406475116,-0.4559066935084586,-0.4613698710767671,-0.4668156102783122,-0.47224370528084697,-0.47765395091901963,-0.48304614270213103,-0.4884200768218623,-0.4937755501599771,-0.4991123602960012,-0.504430305514872,-0.509729184814563,-0.51500879791368,-0.5202689452590334,-0.5255094280331793,-0.5307300481619331,-0.5359306083218586,-0.5411109119477242,-0.5462707632399341,-0.5514099671719265,-0.5565283294975477,-0.561625656758393,-0.5667017562911174,-0.5717564362347201,-0.5767895055377946,-0.5818007739657509,-0.5867900521080043,-0.5917571513851362,-0.5967018840560212,-0.6016240632249223,-0.6065235028485565,-0.6114000177431256,-0.6162534235913162,-0.6210835369492651,-0.6258901752534948,-0.6306731568278127,-0.6354323008901773,-0.6401674275595328,-0.6448783578626073,-0.6495649137406769,-0.6542269180562961,-0.6588641945999936,-0.6634765680969325,-0.6680638642135333,-0.6726259095640659,-0.6771625317172014,-0.68167355920253,-0.6861588215170412,-0.6906181491315695,-0.6950513734972018,-0.6994583270516469,-0.7038388432255706,-0.7081927564488903,-0.7125199021570338,-0.7168201167971577,-0.7210932378343317,-0.7253391037576804,-0.7295575540864874,-0.7337484293762624,-0.7379115712247669,-0.7420468222780019,-0.7461540262361537,-0.7502330278595041,-0.7542836729742964,-0.7583058084785623,-0.7622992823479104,-0.7662639436412699,-0.7701996425065991,-0.7741062301865453,-0.7779835590240698,-0.7818314824680297,-0.7856498550787139,-0.7894385325333443,-0.793197371631527,-0.7969262303006667,-0.8006249676013376,-0.8042934437326082,-0.8079315200373262,-0.8115390590073609,-0.815115924288798,-0.8186619806870945,-0.8221770941721904,-0.825661131883571,-0.8291139621352912,-0.8325354544209532,-0.8359254794186365,-0.8392839089957895,-0.8426106162140693,-0.8459054753341406,-0.8491683618204307,-0.8523991523458321,-0.8555977247963669,-0.8587639582758029,-0.8618977331102203,-0.8649989308525369,-0.8680674342869857,-0.8711031274335433,-0.8741058955523144,-0.8770756251478703,-0.8800122039735352,-0.8829155210356328,-0.8857854665976778,-0.8886219321845258,-0.8914248105864737,-0.8941939958633102,-0.8969293833483202,-0.8996308696522433,-0.9022983526671783,-0.9049317315704444,-0.9075309068283925,-0.9100957802001656,-0.9126262547414125,-0.9151222348079536,-0.9175836260593934,-0.920010335462689,-0.9224022712956635,-0.924759343150475,-0.9270814619370339,-0.9293685398863681,-0.9316204905539422,-0.9338372288229251,-0.9360186709074054,-0.9381647343555595,-0.9402753380527684,-0.9423504022246824,-0.9443898484402368,-0.9463935996146172,-0.9483615800121713,-0.9502937152492736,-0.9521899322971352,-0.9540501594845641,-0.9558743265006759,-0.9576623643975495,-0.9594142055928331,-0.9611297838723006,-0.9628090343923521,-0.9644518936824655,-0.9660582996475965,-0.9676281915705237,-0.9691615101141451,-0.9706581973237204,-0.9721181966290613,-0.9735414528466696,-0.9749279121818236,-0.9762775222306104,-0.9775902319819079,-0.9788659918193116,-0.9801047535230102,-0.9813064702716093,-0.9824710966438995,-0.9835985886205741,-0.9846889035858932,-0.9857420003292933,-0.9867578390469455,-0.9877363813432609,-0.9886775902323404,-0.989581430139373,-0.9904478669019816,-0.9912768677715121,-0.9920684014142734,-0.9928224379127202,-0.9935389487665841,-0.9942179068939518,-0.9948592866322874,-0.9954630637394027,-0.9960292153943743,-0.996557720198405,-0.9970485581756334,-0.9975017107738888,-0.9979171608653922,-0.9982948927474035,-0.9986348921428155,-0.9989371462006936,-0.999201643496761,-0.9994283740338304,-0.9996173292421829,-0.9997685019798909,-0.999881886533088,-0.9999574786161859,-0.9999952753720357,-0.9999952753720357,-0.999957478616186,-0.999881886533088,-0.9997685019798909,-0.999617329242183,-0.9994283740338304,-0.999201643496761,-0.9989371462006937,-0.9986348921428156,-0.9982948927474035,-0.9979171608653922,-0.9975017107738889,-0.9970485581756335,-0.996557720198405,-0.9960292153943743,-0.9954630637394029,-0.9948592866322874,-0.994217906893952,-0.9935389487665843,-0.9928224379127202,-0.9920684014142735,-0.9912768677715122,-0.9904478669019816,-0.9895814301393733,-0.9886775902323405,-0.987736381343261,-0.9867578390469457,-0.9857420003292933,-0.9846889035858932,-0.9835985886205744,-0.9824710966438996,-0.9813064702716093,-0.9801047535230104,-0.9788659918193116,-0.9775902319819082,-0.9762775222306107,-0.9749279121818236,-0.9735414528466698,-0.9721181966290614,-0.9706581973237205,-0.9691615101141453,-0.9676281915705238,-0.9660582996475966,-0.9644518936824659,-0.9628090343923522,-0.9611297838723007,-0.9594142055928334,-0.9576623643975496,-0.9558743265006764,-0.9540501594845645,-0.9521899322971353,-0.9502937152492741,-0.9483615800121717,-0.9463935996146173,-0.9443898484402372,-0.9423504022246825,-0.9402753380527685,-0.9381647343555598,-0.9360186709074055,-0.9338372288229252,-0.9316204905539427,-0.9293685398863683,-0.927081461937034,-0.9247593431504755,-0.9224022712956637,-0.9200103354626894,-0.9175836260593939,-0.9151222348079537,-0.9126262547414129,-0.9100957802001657,-0.9075309068283927,-0.9049317315704449,-0.9022983526671785,-0.8996308696522434,-0.8969293833483207,-0.8941939958633103,-0.8914248105864739,-0.8886219321845263,-0.885785466597678,-0.8829155210356333,-0.8800122039735359,-0.8770756251478705,-0.8741058955523151,-0.8711031274335436,-0.868067434286986,-0.8649989308525375,-0.8618977331102204,-0.8587639582758031,-0.8555977247963675,-0.8523991523458323,-0.8491683618204308,-0.8459054753341413,-0.8426106162140694,-0.8392839089957902,-0.8359254794186372,-0.8325354544209534,-0.8291139621352919,-0.8256611318835713,-0.8221770941721905,-0.8186619806870953,-0.8151159242887982,-0.8115390590073611,-0.8079315200373268,-0.8042934437326085,-0.8006249676013378,-0.7969262303006674,-0.7931973716315273,-0.7894385325333451,-0.7856498550787147,-0.7818314824680299,-0.7779835590240706,-0.7741062301865456,-0.7701996425065993,-0.7662639436412708,-0.7622992823479107,-0.7583058084785625,-0.754283672974297,-0.7502330278595046,-0.746154026236154,-0.7420468222780024,-0.7379115712247675,-0.7337484293762632,-0.7295575540864879,-0.7253391037576806,-0.7210932378343325,-0.7168201167971583,-0.712519902157034,-0.7081927564488912,-0.7038388432255712,-0.6994583270516471,-0.6950513734972024,-0.69061814913157,-0.6861588215170414,-0.6816735592025307,-0.677162531717202,-0.6726259095640669,-0.6680638642135339,-0.6634765680969327,-0.6588641945999946,-0.6542269180562967,-0.6495649137406772,-0.6448783578626082,-0.6401674275595335,-0.6354323008901775,-0.6306731568278133,-0.6258901752534953,-0.6210835369492653,-0.6162534235913169,-0.6114000177431262,-0.6065235028485575,-0.601624063224923,-0.5967018840560215,-0.5917571513851372,-0.586790052108005,-0.5818007739657513,-0.5767895055377956,-0.5717564362347207,-0.5667017562911177,-0.5616256567583937,-0.5565283294975485,-0.5514099671719268,-0.5462707632399348,-0.5411109119477249,-0.5359306083218589,-0.5307300481619338,-0.5255094280331797,-0.5202689452590346,-0.5150087979136807,-0.5097291848145633,-0.504430305514873,-0.4991123602960019,-0.49377555015997737,-0.488420076821863,-0.48304614270213175,-0.47765395091901997,-0.4722437052808477,-0.4668156102783129,-0.4613698710767674,-0.4559066935084593,-0.4504262840647515,-0.4449288498883218,-0.4394145987653278,-0.43388373911755834,-0.42833647999455365,-0.4227730310657015,-0.41719360261231697,-0.41159840551969235,-0.4059876512691235,-0.40036155192992184,-0.3947203201513959,-0.38906416915481173,-0.38339331272533844,-0.37770796520396543,-0.37200834147939854,-0.3662946569799436,-0.3605671276653573,-0.35482597001869043,-0.34907140103810286,-0.34330363822865934,-0.33752289959411347,-0.3317294036286651,-0.32592336930869975,-0.32010501608451664,-0.31427456387203195,-0.30843223304446393,-0.3025782444240086,-0.29671281927349086,-0.29083617928799876,-0.2849485465865102,-0.2790501437034906,-0.2731411935804879,-0.2672219195577032,-0.2612925453655468,-0.2553532951161872,-0.2494043932950775,-0.2434460647524679,-0.23747853469491256,-0.23150202867675462,-0.22551677259159836,-0.21952299266377648,-0.21352091543979668,-0.20751076777977653,-0.20149277684887476,-0.1954671701086982,-0.1894341753087106,-0.18339402047762163,-0.17734693391476564,-0.1712931441814778,-0.16523288009245254,-0.15916637070709252,-0.15309384532085601,-0.14701553345658774,-0.1409316648558409,-0.13484246947019896,-0.12874817745258146,-0.1226490191485424,-0.11654522508757002,-0.11043702597436646,-0.10432465268013393,-0.09820833623384588,-0.09208830781351221,-0.0859647987374467,-0.07983804045552124,-0.07370826454041508,-0.06757570267886742,-0.061440586662917684,-0.055303148381141864,-0.04916361980989312,-0.04302223300453115,-0.03687922009064856,-0.0307348132553034,-0.024589244738236142,-0.01844274682309792,-0.012295551828668278,-0.006147892100071544,-2.4492935982947064e-16
    };

};

template <
    class _real
>_real fastcos(_real n)
    {
        fast_cossin_table_class<_real> fast_cossin_table;

        _real f = n * (_real)HALF_MAX_CIRCLE_ANGLE_PI;
        int i;

        i = (int) f;
        if (i < 0) {
            return fast_cossin_table.table[((-i) + QUARTER_MAX_CIRCLE_ANGLE)&MASK_MAX_CIRCLE_ANGLE];
        }
        else {
            return fast_cossin_table.table[(i + QUARTER_MAX_CIRCLE_ANGLE)&MASK_MAX_CIRCLE_ANGLE];
        }
    }

template <
    typename _real
>_real fastsin(_real n)
    {
        fast_cossin_table_class<_real> fast_cossin_table;

        //_real f = n * (_real)HALF_MAX_CIRCLE_ANGLE_PI;
        //_real f = n;
        int16_t i, index;
        i = (int16_t) n;

        // int temp = i&MASK_MAX_CIRCLE_ANGLE;
        // std::cout << temp << std::endl;
        index = (i < 0)? (-((-i)&(int16_t)MASK_MAX_CIRCLE_ANGLE)) + (int16_t)MAX_CIRCLE_ANGLE : i&(int16_t)MASK_MAX_CIRCLE_ANGLE;
        return fast_cossin_table.table[index];
    }

#endif
